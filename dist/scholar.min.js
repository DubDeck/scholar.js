/*!
 * scholar.js 0.1.1 (2016-02-27)
 * https://github.com/jlevallois/scholar.js
 * CC-BY-NC-SA-4.0 licensed
 *
 * Copyright (C) 2016 Jérémy Levallois, http://karganys.fr
 */
var Scholar={author:"SCHOLAR_AUTHOR_ID",scholar_url:"http://scholar.google.com/",debug:!1,publi_name:[],publi_id:[],publi_cite_count:[],load:function(a){"use strict";var b=0,c=0;this.author=a,this.debug&&console.log("Preloading author "+this.author),$.ajax({url:Scholar.scholar_url+"citations?user="+Scholar.author+"&hl=en&cstart=0&pagesize=100",type:"GET",dataType:"html",success:function(a){var d=$(a.responseText).find("#gsc_a_b"),e=$(d).find(".gsc_a_t").find("a"),f=$(d).find(".gsc_a_c");Scholar.publi_name=[],Scholar.publi_id=[],Scholar.publi_cite_count=[];var g=new RegExp(".*(citation_for_view=[\\d\\w\\-_]+\\:)");for(b=0;b<e.length;b++)Scholar.publi_name.push($(e[b]).text()),Scholar.publi_id.push($(e[b]).attr("href").replace(g,"")),Scholar.publi_cite_count.push($(f[b]).text());if(Scholar.debug)if(console.log("Found "+Scholar.publi_name.length+" publications"),Scholar.publi_name.length!==Scholar.publi_cite_count.length)console.log("Wrong number of publications and cites count : "+Scholar.publi_name.length+" and "+Scholar.publi_cite_count.length);else for(console.log("----------------------------------"),b=0;b<Scholar.publi_name.length;b++)console.log("Name: "+Scholar.publi_name[b]),console.log("ID: "+Scholar.publi_id[b]),console.log("Cite: "+Scholar.publi_cite_count[b]),console.log("----------------------------------");var h=document.getElementsByClassName("scholar");for(b=0;b<h.length;b++){Scholar.debug&&console.log("Asking for: "+h[b].getAttribute("name"));var i=!1;for(c=0;c<Scholar.publi_name.length&&!i;c++)if(Scholar.publi_name[c].toLowerCase()===h[b].getAttribute("name").toLowerCase()){var j=Scholar.publi_cite_count[c]<1?0:Scholar.publi_cite_count[c];Scholar.debug&&console.log("Publication found. Count: "+j),"true"===h[b].getAttribute("with-link")?h[b].innerHTML='<a href="'+Scholar.scholar_url+"citations?view_op=view_citation&hl=en&user="+Scholar.author+"&citation_for_view="+Scholar.author+":"+Scholar.publi_id[c]+'">'+j+"</a>":h[b].innerHTML=j,i=!0}i||(h[b].innerHTML="&#10008")}},error:function(){Scholar.debug&&console.log("Can't open requested URL.");var a=document.getElementsByClassName("scholar");for(b=0;b<a.length;b++)a[b].innerHTML="&#10008"},complete:function(a){}})}};jQuery.ajax=function(a){"use strict";function b(a){return!e.test(a)&&/:\/\//.test(a)}var c=location.protocol,d=location.hostname,e=new RegExp(c+"//"+d),f="http"+(/^https/.test(c)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?",g='select * from html where url="{URL}" and xpath="*"';return function(c){var d=c.url;return"undefined"!=typeof c.type&&!/get/i.test(c.type)||/json/i.test(c.dataType)||!b(d)||(c.url=f,c.dataType="json",c.data={q:g.replace("{URL}",d+(c.data?(/\?/.test(d)?"&":"?")+jQuery.param(c.data):"")),format:"xml"},!c.success&&c.complete&&(c.success=c.complete,delete c.complete),c.success=function(a){return function(b){a&&a.call(this,{responseText:b.results[0].replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"").replace(/<img[^>]+?\/>|<img(.|\s)*?\/img>/gi,"")},"success")}}(c.success)),a.apply(this,arguments)}}(jQuery.ajax);