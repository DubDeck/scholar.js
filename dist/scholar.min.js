/*!
 * scholar.js 0.1.1 (2017-11-13)
 * https://github.com/jlevallois/scholar.js
 * CC-BY-NC-SA-4.0 licensed
 *
 * Copyright (C) 2016 Jérémy Levallois, http://karganys.fr
 */
var Scholar={author:"SCHOLAR_AUTHOR_ID",scholarURL:"https://scholar.google.com/",debug:!1,not_found_msg:"&#10008",pathToProxy:"proxy.php",load:function(a){"use strict";var b=0,c=0;if("SCHOLAR_AUTHOR_ID"===a){console.log("You must specify your Google Scholar ID. See documentation.");var d=document.getElementsByClassName("scholar");for(b=0;b<d.length;b++)d[b].innerHTML=Scholar.not_found_msg}this.author=a,this.debug&&console.log("Preloading author "+this.author),$.ajax({url:Scholar.scholarURL+"citations?user="+Scholar.author+"&hl=en&cstart=0&pagesize=100",crossOrigin:!0,proxy:Scholar.pathToProxy,type:"GET",dataType:"html",success:function(a){var d=$(a).find("#gsc_a_b"),e=$(d).find(".gsc_a_at"),f=$(d).find(".gsc_a_c"),g=[],h=[],i=[],j=new RegExp(".*(citation_for_view=[\\d\\w\\-_]+\\:)");for(b=0;b<e.length;b++)g.push($(e[b]).text()),h.push($(e[b]).attr("data-href").replace(j,"")),i.push($(f[b]).text());if(Scholar.debug)if(console.log("Found "+g.length+" publications."),g.length!==i.length)console.log("Wrong number of publications and cites count : "+g.length+" and "+i.length);else for(console.log("----------------------------------"),b=0;b<g.length;b++)console.log("Name: "+g[b]),console.log("ID: "+h[b]),console.log("Cite: "+i[b]),console.log("----------------------------------");var k=document.getElementsByClassName("scholar");for(b=0;b<k.length;b++){var l=-1;if(k[b].getAttribute("publi-id"))for(Scholar.debug&&console.log("Asking for publication ID: "+k[b].getAttribute("publi-id")),c=0;c<h.length&&-1===l;c++)h[c]===k[b].getAttribute("publi-id")&&(l=c);else if(k[b].getAttribute("name"))for(Scholar.debug&&console.log("Asking for: "+k[b].getAttribute("name")),c=0;c<g.length&&-1===l;c++)g[c].replace(/[^a-zA-Z]+/g,"").toLowerCase()===k[b].getAttribute("name").replace(/[^a-zA-Z]+/g,"").toLowerCase()&&(l=c);else Scholar.debug&&console.log("No attribute 'publi-id' or 'name' found for this publication.");if(-1!==l){var m=i[l]<1?0:i[l];if(Scholar.debug&&console.log("Publication found. Count: "+m),"true"===k[b].getAttribute("with-link")){var n="";k[b].getAttribute("target")&&(n="target="+k[b].getAttribute("target")),k[b].innerHTML="<a "+n+' href="'+Scholar.scholarURL+"citations?view_op=view_citation&hl=en&user="+Scholar.author+"&citation_for_view="+Scholar.author+":"+h[l]+'">'+m+"</a>"}else k[b].innerHTML=m}else k[b].innerHTML=Scholar.not_found_msg}},error:function(){Scholar.debug&&console.log("Can't open requested URL.");var a=document.getElementsByClassName("scholar");for(b=0;b<a.length;b++)a[b].innerHTML=Scholar.not_found_msg}})}};