/*! scholar.js v0.1 | (c) Jérémy Levallois | https://github.com/jlevallois/scholar.js */
var Scholar={author:"SCHOLAR_AUTHOR_ID",scholar_url:"http://scholar.google.com/",debug:!1,publi_name:[],publi_id:[],publi_cite_count:[],load:function(e){this.author=e,this.debug&&console.log("Preloading author "+this.author),$.ajax({url:Scholar.scholar_url+"citations?user="+Scholar.author+"&hl=en&cstart=0&pagesize=100",type:"GET",dataType:"html",success:function(e){var o=$(e.responseText).find("#gsc_a_b"),t=$(o).find(".gsc_a_t").find("a"),l=$(o).find(".gsc_a_c");Scholar.publi_name=[],Scholar.publi_id=[],Scholar.publi_cite_count=[];var a=new RegExp(".*(citation_for_view=[\\d\\w\\-_]+\\:)");for(i=0;i<t.length;i++)Scholar.publi_name.push($(t[i]).text()),Scholar.publi_id.push($(t[i]).attr("href").replace(a,"")),Scholar.publi_cite_count.push($(l[i]).text());if(Scholar.debug)if(console.log("Found "+Scholar.publi_name.length+" publications"),Scholar.publi_name.length!=Scholar.publi_cite_count.length)console.log("Wrong number of publications and cites count : "+Scholar.publi_name.length+" and "+Scholar.publi_cite_count.length);else for(console.log("----------------------------------"),i=0;i<Scholar.publi_name.length;i++)console.log("Name: "+Scholar.publi_name[i]),console.log("ID: "+Scholar.publi_id[i]),console.log("Cite: "+Scholar.publi_cite_count[i]),console.log("----------------------------------");var c=document.getElementsByClassName("scholar");for(i=0;i<c.length;i++){Scholar.debug&&console.log("Asking for: "+c[i].getAttribute("name"));var r=!1;for(j=0;j<Scholar.publi_name.length&&!r;j++)if(Scholar.publi_name[j].toLowerCase()==c[i].getAttribute("name").toLowerCase()){var n=Scholar.publi_cite_count[j]<1?0:Scholar.publi_cite_count[j];Scholar.debug&&console.log("Publication found. Count: "+n),"true"==c[i].getAttribute("with-link")?c[i].innerHTML='<a href="'+Scholar.scholar_url+"citations?view_op=view_citation&hl=en&user="+Scholar.author+"&citation_for_view="+Scholar.author+":"+Scholar.publi_id[j]+'">'+n+"</a>":c[i].innerHTML=n,r=!0}r||(c[i].innerHTML="&#10008")}},error:function(){Scholar.debug&&console.log("Can't open requested URL.");var e=document.getElementsByClassName("scholar");for(i=0;i<e.length;i++)e[i].innerHTML="&#10008"},complete:function(e){}})}};jQuery.ajax=function(e){function o(e){return!i.test(e)&&/:\/\//.test(e)}var t=location.protocol,l=location.hostname,i=RegExp(t+"//"+l),a="http"+(/^https/.test(t)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?",c='select * from html where url="{URL}" and xpath="*"';return function(t){var l=t.url;return"undefined"!=typeof t.type&&!/get/i.test(t.type)||/json/i.test(t.dataType)||!o(l)||(t.url=a,t.dataType="json",t.data={q:c.replace("{URL}",l+(t.data?(/\?/.test(l)?"&":"?")+jQuery.param(t.data):"")),format:"xml"},!t.success&&t.complete&&(t.success=t.complete,delete t.complete),t.success=function(e){return function(o){e&&e.call(this,{responseText:o.results[0].replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"").replace(/<img[^>]+?\/>|<img(.|\s)*?\/img>/gi,"")},"success")}}(t.success)),e.apply(this,arguments)}}(jQuery.ajax);
